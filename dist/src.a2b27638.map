{"version":3,"sources":["src/functions.js","node_modules/deep-is/index.js","src/utilities/uuid.js","node_modules/sbd/lib/sanitize-html-browser.js","node_modules/sbd/lib/stringHelper.js","node_modules/sbd/lib/Match.js","node_modules/sbd/lib/tokenizer.js","src/utilities/inflate.js","src/utilities/index.js","src/editor/empty.js","src/editor/htmlToStringArray.js","src/editor/textToArray.js","src/editor/terminate.js","src/editor/getCandidateString.js","src/editor/arrayToHtml.js","src/editor/index.js","src/editor/collectionToHtml.js","src/index.js","../../../.nvm/versions/node/v8.10.0/lib/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../.nvm/versions/node/v8.10.0/lib/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["dispatch","name","message","elm","window","e","CustomEvent","Object","assign","bubbles","detail","dispatchEvent","subscribe","callback","addEventListener","serial","uuid","Date","valueOf","toString","Math","floor","random","slice","inflate","text","array","SBD","sentences","join","timer","count","delay","time","replace","storage","sufix","ns","filter","val","read","data","localStorage","JSON","parse","write","obj","clearTimeout","setTimeout","console","log","stringify","deepEqual","empty","s","undefined","settings","require","htmlToStringArray","children","options","prefixToken","className","map","el","innerText","classList","is_comment","contains","prefix","trim","textToArray","split","re_punctuation","terminate","autoTerminate","is_closed","test","re_comments","getCandidateString","value","is_array","constructor","Array","line","length","comment","RegExp","arrayToHtml","editor","config","defaultConfig","cache","candidate","versions","triggerDictionary","cleanup","cleanupBlanks","shiftshift","toggleComment","clearVersions","innerHTML","load","initialize","html","focus","notifyChanges","bool","document","getSelection","focusNode","parentNode","skip","nodeName","toggle","rows","forEach","row","n","remove","executeTriggers","keyTime","keyHistory","toLowerCase","trigger","bindEvents","ts","hist","onkeyup","doubleTap","resetDelay","diff","timeStamp","push","key","getVersionArray","onChange","string","nextCandidate","String","nextVersions","a","b","execute","sort","addOnChange","fn","id","selector","querySelector","clear","collectionToHtml","classname","json","div","createElement","dataset","outerHTML","messages","confirmDelete","$focusOn","$doc","sample","local","u","save","$els","collection","updateParent","ondblclick","target","confirm","onclick","selected","add","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","exports","bundle","updateLink","link","newLink","cloneNode","onload","href","now","insertBefore","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","i","module"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,SAASA,QAAT,CAAkBC,IAAlB,EAAsD;AAAA,MAA9BC,OAA8B,uEAApB,IAAoB;AAAA,MAAdC,GAAc,uEAARC,MAAQ;AAC3D,MAAMC,CAAC,GAAG,IAAIC,WAAJ,CACRL,IADQ,EAERM,MAAM,CAACC,MAAP,CAAc;AAAEC,IAAAA,OAAO,EAAE;AAAX,GAAd,EAAiC;AAAEC,IAAAA,MAAM,EAAER;AAAV,GAAjC,CAFQ,CAAV;AAIAC,EAAAA,GAAG,CAACQ,aAAJ,CAAkBN,CAAlB;AACD;;AAEM,SAASO,SAAT,CAAmBX,IAAnB,EAAyBY,QAAzB,EAAiD;AAAA,MAAdV,GAAc,uEAARC,MAAQ;AACtDD,EAAAA,GAAG,CAACW,gBAAJ,CAAqBb,IAArB,EAA2BY,QAA3B;AACD;;ACVD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtGA,IAAIE,MAAM,GAAG,CAAb;;AACA,IAAMC,IAAI,GAAG,SAAPA,IAAO,GAAM;AACjBD,EAAAA,MAAM;AACN,SAAO,CACL,IAAIE,IAAJ,GAAWC,OAAX,GAAqBC,QAArB,CAA8B,EAA9B,IAAoC;AACpCC,EAAAA,IAAI,CAACC,KAAL,CAAW,OAAOD,IAAI,CAACE,MAAL,KAAgB,IAAlC,EAAwCH,QAAxC,CAAiD,EAAjD,CADA,GACuD;AACvD,GAAC,OAAQJ,MAAM,KAAK,IAApB,EAA2BI,QAA3B,CAAoC,CAApC,CAFA,GAEyC;AACzC,IAJK,EAKLI,KALK,CAKC,CAAC,EALF,CAAP;AAMD,CARD;;eAUeP;;;ACXf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"src.a2b27638.map","sourceRoot":"..","sourcesContent":["export function dispatch(name, message = null, elm = window) {\n  const e = new CustomEvent(\n    name,\n    Object.assign({ bubbles: true }, { detail: message })\n  );\n  elm.dispatchEvent(e);\n}\n\nexport function subscribe(name, callback, elm = window) {\n  elm.addEventListener(name, callback);\n}\n","var pSlice = Array.prototype.slice;\nvar Object_keys = typeof Object.keys === 'function'\n    ? Object.keys\n    : function (obj) {\n        var keys = [];\n        for (var key in obj) keys.push(key);\n        return keys;\n    }\n;\n\nvar deepEqual = module.exports = function (actual, expected) {\n  // enforce Object.is +0 !== -0\n  if (actual === 0 && expected === 0) {\n    return areZerosEqual(actual, expected);\n\n  // 7.1. All identical values are equivalent, as determined by ===.\n  } else if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  } else if (isNumberNaN(actual)) {\n    return isNumberNaN(expected);\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (typeof actual != 'object' && typeof expected != 'object') {\n    return actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected);\n  }\n};\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction isNumberNaN(value) {\n  // NaN === NaN -> false\n  return typeof value == 'number' && value !== value;\n}\n\nfunction areZerosEqual(zeroA, zeroB) {\n  // (1 / +0|0) -> Infinity, but (1 / -0) -> -Infinity and (Infinity !== -Infinity)\n  return (1 / zeroA) === (1 / zeroB);\n}\n\nfunction objEquiv(a, b) {\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b);\n  }\n  try {\n    var ka = Object_keys(a),\n        kb = Object_keys(b),\n        key, i;\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key])) return false;\n  }\n  return true;\n}\n","let serial = 0;\nconst uuid = () => {\n  serial++;\n  return (\n    new Date().valueOf().toString(16) + // eg 127b795136 (11)\n    Math.floor(1000 + Math.random() * 1000).toString(13) + // eg aa7 (3)\n    (1000 + (serial++ % 1000)).toString(5) + // eg 13001 (5)\n    \"\"\n  ).slice(-16);\n};\n\nexport default uuid;\n","\r\nmodule.exports = function sanitizeHtml(text, opts) {\r\n  // Strip HTML from Text using browser HTML parser\r\n  if ((typeof text == 'string' || text instanceof String) && typeof document !== \"undefined\") {\r\n    var $div = document.createElement(\"DIV\");\r\n    $div.innerHTML = text;\r\n    text = ($div.textContent || '').trim();\r\n  }\r\n  //DOM Object\r\n  else if (typeof text === 'object' && text.textContent) {\r\n    text = (text.textContent || '').trim();\r\n  }\r\n\r\n  return text;\r\n};\r\n","\r\nexports.endsWithChar = function ends_with_char(word, c) {\r\n    if (c.length > 1) {\r\n        return c.indexOf(word.slice(-1)) > -1;\r\n    }\r\n\r\n    return word.slice(-1) === c;\r\n};\r\n\r\nexports.endsWith = function ends_with(word, end) {\r\n    return word.slice(word.length - end.length) === end;\r\n};","var abbreviations;\r\nvar englishAbbreviations = [\r\n    \"al\",\r\n    \"adj\",\r\n    \"assn\",\r\n    \"Ave\",\r\n    \"BSc\", \"MSc\",\r\n    \"Cell\",\r\n    \"Ch\",\r\n    \"Co\",\r\n    \"cc\",\r\n    \"Corp\",\r\n    \"Dem\",\r\n    \"Dept\",\r\n    \"ed\",\r\n    \"eg\",\r\n    \"Eq\",\r\n    \"Eqs\",\r\n    \"est\",\r\n    \"est\",\r\n    \"etc\",\r\n    \"Ex\",\r\n    \"ext\", // + number?\r\n    \"Fig\",\r\n    \"fig\",\r\n    \"Figs\",\r\n    \"figs\",\r\n    \"i.e\",\r\n    \"ie\",\r\n    \"Inc\",\r\n    \"inc\",\r\n    \"Jan\",\"Feb\",\"Mar\",\"Apr\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Sept\",\"Oct\",\"Nov\",\"Dec\",\r\n    \"jr\",\r\n    \"mi\",\r\n    \"Miss\", \"Mrs\", \"Mr\", \"Ms\",\r\n    \"Mol\",\r\n    \"mt\",\r\n    \"mts\",\r\n    \"no\",\r\n    \"Nos\",\r\n    \"PhD\", \"MD\", \"BA\", \"MA\", \"MM\",\r\n    \"pl\",\r\n    \"pop\",\r\n    \"pp\",\r\n    \"Prof\", \"Dr\",\r\n    \"pt\",\r\n    \"Ref\",\r\n    \"Refs\",\r\n    \"Rep\",\r\n    \"repr\",\r\n    \"rev\",\r\n    \"Sec\",\r\n    \"Secs\",\r\n    \"Sgt\", \"Col\", \"Gen\", \"Rep\", \"Sen\",'Gov', \"Lt\", \"Maj\", \"Capt\",\"St\",\r\n    \"Sr\", \"sr\", \"Jr\", \"jr\", \"Rev\",\r\n    \"Sun\",\"Mon\",\"Tu\",\"Tue\",\"Tues\",\"Wed\",\"Th\",\"Thu\",\"Thur\",\"Thurs\",\"Fri\",\"Sat\",\r\n    \"trans\",\r\n    \"Univ\",\r\n    \"Viz\",\r\n    \"Vol\",\r\n    \"vs\",\r\n    \"v\",\r\n];\r\n\r\nexports.setAbbreviations = function(abbr) {\r\n    if(abbr){\r\n        abbreviations = abbr;\r\n    } else {\r\n        abbreviations = englishAbbreviations;\r\n    }\r\n}\r\n\r\nvar isCapitalized = exports.isCapitalized = function(str) {\r\n    return /^[A-Z][a-z].*/.test(str) || isNumber(str);\r\n}\r\n\r\n// Start with opening quotes or capitalized letter\r\nexports.isSentenceStarter = function(str) {\r\n    return isCapitalized(str) || /``|\"|'/.test(str.substring(0,2));\r\n}\r\n\r\nexports.isCommonAbbreviation = function(str) {\r\n    return ~abbreviations.indexOf(str.replace(/\\W+/g, ''));\r\n}\r\n\r\n// This is going towards too much rule based\r\nexports.isTimeAbbreviation = function(word, next) {\r\n    if (word === \"a.m.\" || word === \"p.m.\") {\r\n        var tmp = next.replace(/\\W+/g, '').slice(-3).toLowerCase();\r\n\r\n        if (tmp === \"day\") {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexports.isDottedAbbreviation = function(word) {\r\n    var matches = word.replace(/[\\(\\)\\[\\]\\{\\}]/g, '').match(/(.\\.)*/);\r\n    return matches && matches[0].length > 0;\r\n}\r\n\r\n// TODO look for next words, if multiple are capitalized,\r\n// then it's probably not a sentence ending\r\nexports.isCustomAbbreviation = function(str) {\r\n    if (str.length <= 3) {\r\n        return true;\r\n    }\r\n\r\n    return isCapitalized(str);\r\n}\r\n\r\n// Uses current word count in sentence and next few words to check if it is\r\n// more likely an abbreviation + name or new sentence.\r\nexports.isNameAbbreviation = function(wordCount, words) {\r\n    if (words.length > 0) {\r\n        if (wordCount < 5 && words[0].length < 6 && isCapitalized(words[0])) {\r\n            return true;\r\n        }\r\n\r\n        var capitalized = words.filter(function(str) {\r\n            return /[A-Z]/.test(str.charAt(0));\r\n        });\r\n\r\n        return capitalized.length >= 3;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nvar isNumber = exports.isNumber = function(str, dotPos) {\r\n    if (dotPos) {\r\n        str = str.slice(dotPos-1, dotPos+2);\r\n    }\r\n\r\n    return !isNaN(str);\r\n};\r\n\r\n// Phone number matching\r\n// http://stackoverflow.com/a/123666/951517\r\nexports.isPhoneNr = function(str) {\r\n    return str.match(/^(?:(?:\\+?1\\s*(?:[.-]\\s*)?)?(?:\\(\\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\\s*\\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\\s*(?:[.-]\\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\\s*(?:[.-]\\s*)?([0-9]{4})(?:\\s*(?:#|x\\.?|ext\\.?|extension)\\s*(\\d+))?$/);\r\n};\r\n\r\n// Match urls / emails\r\n// http://stackoverflow.com/a/3809435/951517\r\nexports.isURL = function(str) {\r\n    return str.match(/[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/);\r\n};\r\n\r\n// Starting a new sentence if beginning with capital letter\r\n// Exception: The word is enclosed in brackets\r\nexports.isConcatenated = function(word) {\r\n    var i = 0;\r\n\r\n    if ((i = word.indexOf(\".\")) > -1 ||\r\n        (i = word.indexOf(\"!\")) > -1 ||\r\n        (i = word.indexOf(\"?\")) > -1)\r\n    {\r\n        var c = word.charAt(i + 1);\r\n\r\n        // Check if the next word starts with a letter\r\n        if (c.match(/[a-zA-Z].*/)) {\r\n            return [word.slice(0, i), word.slice(i+1)];\r\n        }\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nexports.isBoundaryChar = function(word) {\r\n    return word === \".\" ||\r\n           word === \"!\" ||\r\n           word === \"?\";\r\n};\r\n","/*jshint node:true, laxcomma:true */\r\n\"use strict\";\r\n\r\nvar sanitizeHtml = require('sanitize-html');\r\n\r\nvar stringHelper = require('./stringHelper');\r\nvar Match  = require('./Match');\r\n\r\nvar newline_placeholder = \" @~@ \";\r\nvar newline_placeholder_t = newline_placeholder.trim();\r\n\r\n\r\nvar whiteSpaceCheck = new RegExp(\"\\\\S\", \"\");\r\nvar addNewLineBoundaries = new RegExp(\"\\\\n+|[-#=_+*]{4,}\", \"g\");\r\nvar splitIntoWords = new RegExp(\"\\\\S+|\\\\n\", \"g\");\r\n\r\n\r\n// Split the entry into sentences.\r\nexports.sentences = function(text, user_options) {\r\n    if (!text || typeof text !== \"string\" || !text.length) {\r\n        return [];\r\n    }\r\n\r\n    if (!whiteSpaceCheck.test(text)) {\r\n      // whitespace-only string has no sentences\r\n      return [];\r\n    }\r\n\r\n    var options = {\r\n        \"newline_boundaries\"  : false,\r\n        \"html_boundaries\"     : false,\r\n        \"html_boundaries_tags\": [\"p\",\"div\",\"ul\",\"ol\"],\r\n        \"sanitize\"            : false,\r\n        \"allowed_tags\"        : false,\r\n        \"preserve_whitespace\" : false,\r\n        \"abbreviations\"       : null\r\n    };\r\n\r\n    if (typeof user_options === \"boolean\") {\r\n        // Deprecated quick option\r\n        options.newline_boundaries = true;\r\n    }\r\n    else {\r\n        // Extend options\r\n        for (var k in user_options) {\r\n            options[k] = user_options[k];\r\n        }\r\n    }\r\n\r\n    Match.setAbbreviations(options.abbreviations);\r\n\r\n    if (options.newline_boundaries) {\r\n        text = text.replace(addNewLineBoundaries, newline_placeholder);\r\n    }\r\n\r\n    if (options.html_boundaries) {\r\n        var html_boundaries_regexp = \"(<br\\\\s*\\\\/?>|<\\\\/(\" + options.html_boundaries_tags.join(\"|\") + \")>)\";\r\n        var re = new RegExp(html_boundaries_regexp, \"g\");\r\n        text = text.replace(re, \"$1\" + newline_placeholder);\r\n    }\r\n\r\n    if (options.sanitize || options.allowed_tags) {\r\n        if (! options.allowed_tags) {\r\n            options.allowed_tags = [\"\"];\r\n        }\r\n\r\n        text = sanitizeHtml(text, { \"allowedTags\" : options.allowed_tags });\r\n    }\r\n\r\n\r\n    // Split the text into words\r\n    var words;\r\n    var tokens;\r\n\r\n    // Split the text into words\r\n    if (options.preserve_whitespace) {\r\n        // <br> tags are the odd man out, as whitespace is allowed inside the tag\r\n        tokens = text.split(/(<br\\s*\\/?>|\\S+|\\n+)/);\r\n\r\n        // every other token is a word\r\n        words = tokens.filter(function (token, ii) {\r\n          return ii % 2;\r\n        });\r\n    }\r\n    else {\r\n        // - see http://blog.tompawlak.org/split-string-into-tokens-javascript\r\n        words = text.trim().match(splitIntoWords);\r\n    }\r\n\r\n\r\n    var wordCount = 0;\r\n    var index = 0;\r\n    var temp  = [];\r\n    var sentences = [];\r\n    var current   = [];\r\n\r\n    // If given text is only whitespace (or nothing of \\S+)\r\n    if (!words || !words.length) {\r\n        return [];\r\n    }\r\n\r\n    for (var i=0, L=words.length; i < L; i++) {\r\n        wordCount++;\r\n\r\n        // Add the word to current sentence\r\n        current.push(words[i]);\r\n\r\n        // Sub-sentences, reset counter\r\n        if (~words[i].indexOf(',')) {\r\n            wordCount = 0;\r\n        }\r\n\r\n        if (Match.isBoundaryChar(words[i]) || stringHelper.endsWithChar(words[i], \"?!\") || words[i] === newline_placeholder_t) {\r\n            if ((options.newline_boundaries || options.html_boundaries) && words[i] === newline_placeholder_t) {\r\n                current.pop();\r\n            }\r\n\r\n            sentences.push(current);\r\n\r\n            wordCount = 0;\r\n            current   = [];\r\n\r\n            continue;\r\n        }\r\n\r\n\r\n        if (stringHelper.endsWithChar(words[i], \"\\\"\") || stringHelper.endsWithChar(words[i], \"â€\")) {\r\n            words[i] = words[i].slice(0, -1);\r\n        }\r\n\r\n        // A dot might indicate the end sentences\r\n        // Exception: The next sentence starts with a word (non abbreviation)\r\n        //            that has a capital letter.\r\n        if (stringHelper.endsWithChar(words[i], '.')) {\r\n            // Check if there is a next word\r\n            // This probably needs to be improved with machine learning\r\n            if (i+1 < L) {\r\n                // Single character abbr.\r\n                if (words[i].length === 2 && isNaN(words[i].charAt(0))) {\r\n                    continue;\r\n                }\r\n\r\n                // Common abbr. that often do not end sentences\r\n                if (Match.isCommonAbbreviation(words[i])) {\r\n                    continue;\r\n                }\r\n\r\n                // Next word starts with capital word, but current sentence is\r\n                // quite short\r\n                if (Match.isSentenceStarter(words[i+1])) {\r\n                    if (Match.isTimeAbbreviation(words[i], words[i+1])) {\r\n                        continue;\r\n                    }\r\n\r\n                    // Dealing with names at the start of sentences\r\n                    if (Match.isNameAbbreviation(wordCount, words.slice(i, 6))) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Match.isNumber(words[i+1])) {\r\n                        if (Match.isCustomAbbreviation(words[i])) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Skip ellipsis\r\n                    if (stringHelper.endsWith(words[i], \"..\")) {\r\n                        continue;\r\n                    }\r\n\r\n                    //// Skip abbreviations\r\n                    // Short words + dot or a dot after each letter\r\n                    if (Match.isDottedAbbreviation(words[i])) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Match.isNameAbbreviation(wordCount, words.slice(i, 5))) {\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n\r\n            sentences.push(current);\r\n            current   = [];\r\n            wordCount = 0;\r\n\r\n            continue;\r\n        }\r\n\r\n        // Check if the word has a dot in it\r\n        if ((index = words[i].indexOf(\".\")) > -1) {\r\n            if (Match.isNumber(words[i], index)) {\r\n                continue;\r\n            }\r\n\r\n            // Custom dotted abbreviations (like K.L.M or I.C.T)\r\n            if (Match.isDottedAbbreviation(words[i])) {\r\n                continue;\r\n            }\r\n\r\n            // Skip urls / emails and the like\r\n            if (Match.isURL(words[i]) || Match.isPhoneNr(words[i])) {\r\n                continue;\r\n            }\r\n        }\r\n\r\n        if (temp = Match.isConcatenated(words[i])) {\r\n            current.pop();\r\n            current.push(temp[0]);\r\n            sentences.push(current);\r\n\r\n            current = [];\r\n            wordCount = 0;\r\n            current.push(temp[1]);\r\n        }\r\n    }\r\n\r\n    if (current.length) {\r\n        sentences.push(current);\r\n    }\r\n\r\n\r\n    // Clear \"empty\" sentences\r\n    sentences = sentences.filter(function(s) {\r\n        return s.length > 0;\r\n    });\r\n\r\n    var result = sentences.slice(1).reduce(function (out, sentence) {\r\n      var lastSentence = out[out.length - 1];\r\n      // Single words, could be \"enumeration lists\"\r\n      if (lastSentence.length === 1 && /^.{1,2}[.]$/.test(lastSentence[0])) {\r\n          // Check if there is a next sentence\r\n          // It should not be another list item\r\n          if (!/[.]/.test(sentence[0])) {\r\n              out.pop()\r\n              out.push(lastSentence.concat(sentence));\r\n              return out;\r\n          }\r\n      }\r\n      out.push(sentence);\r\n      return out;\r\n    }, [ sentences[0] ]);\r\n\r\n    // join tokens back together\r\n    return result.map(function (sentence, ii) {\r\n      if (options.preserve_whitespace && !options.newline_boundaries && !options.html_boundaries) {\r\n        // tokens looks like so: [leading-space token, non-space token, space\r\n        // token, non-space token, space token... ]. In other words, the first\r\n        // item is the leading space (or the empty string), and the rest of\r\n        // the tokens are [non-space, space] token pairs.\r\n        var tokenCount = sentence.length * 2;\r\n        if (ii === 0) {\r\n          tokenCount += 1;\r\n        }\r\n        return tokens.splice(0, tokenCount).join('');\r\n      }\r\n      return sentence.join(\" \");\r\n    });\r\n};\r\n","import SBD from \"sbd\";\n\nfunction inflate(text) {\n  // returns sentences broken into lines\n  const array = SBD.sentences(text);\n  return array.join(\"\\n\\n\");\n}\n\nexport default inflate;\n","import deepEqual from \"deep-is\";\nimport uuid from \"./uuid\";\nimport inflate from \"./inflate\";\n\nlet timer;\nlet count = 0;\nlet delay = 250;\n\nfunction time() {\n  return new Date().toString().replace(/.* (\\d+:\\d+:\\d+) .*/g, \"$1\");\n}\nfunction storage(sufix = null) {\n  const ns = [\"rewrite\", sufix].filter(val => val).join(\"-\");\n\n  return {\n    read: () => {\n      const data = localStorage[ns] || null;\n      return data && JSON.parse(data);\n    },\n\n    write: obj => {\n      clearTimeout(timer);\n      count = (count || 0) + 1;\n      timer = setTimeout(() => {\n        console.log(\"localstroage SAVE\", count, time());\n        localStorage[ns] = JSON.stringify(obj);\n        count = 0;\n      }, delay);\n    }\n  };\n}\n\nexport default {\n  uuid,\n  deepEqual,\n  inflate,\n  storage,\n  time\n};\n","function empty(s) {\n  if (s === undefined) return;\n  return s;\n}\n\nexport default empty;\n","const settings = require(\"./config\");\n\nfunction htmlToStringArray(children, options = {}) {\n  const { prefixToken, className } = { ...settings, ...options };\n\n  return [...children].map(el => {\n    const { innerText, classList } = el;\n    const is_comment = classList.contains(className);\n    const prefix = is_comment ? prefixToken : \"\";\n\n    return `${prefix}${innerText.trim()}`;\n  });\n}\n\nexport default htmlToStringArray;\n","function textToArray(text = null) {\n  // returns simple text Array\n  // correcting for double line breaks\n  if (!text) return;\n\n  return text.replace(/\\n\\n/gm, \"\\n\").split(/\\n/g);\n}\n\nexport default textToArray;\n","const re_punctuation = /(\\.|\\:|\\!|\\?|\\\"|\\))$/g;\n\nfunction terminate(text, autoTerminate = false) {\n  // return a closed sentnece.\n  text = text && text.trim();\n\n  if (!text) return;\n\n  var is_closed = re_punctuation.test(text);\n  var sufix = autoTerminate && !is_closed ? \".\" : \"\";\n\n  return `${text}${sufix}`;\n}\n\nexport default terminate;\n","import terminate from \"./terminate\";\nimport textToArray from \"./textToArray\";\n\nconst re_comments = /^([\\/\\>\\?\\=\\!]\\s*?)/;\n\nfunction getCandidateString(value, autoTerminate = false) {\n  // recieve String or Array\n  // returns string\n  // parse the DOM elements to simple Array\n\n  const is_array = value && value.constructor === Array;\n  const array = is_array ? value : textToArray(value);\n  return [...array]\n    .map(line =>\n      re_comments.test(line) ? null : terminate(line, autoTerminate)\n    )\n    .filter(s => s && s.length)\n    .join(\" \")\n    .trim();\n}\n\nexport default getCandidateString;\n","const comment = new RegExp(\"^[>]s?\", \"g\");\n\nfunction arrayToHtml(array) {\n  // returns DOM string\n  // parse comment chars to className \"comment\"\n\n  return [...array]\n    .map(text => {\n      const className = comment.test(text) ? ` class=\"comment\"` : \"\";\n      const value = text ? text.replace(comment, \"\").trim() : \"<br />\";\n\n      return `<div${className}>${value}</div>`;\n    })\n    .join(\"\\n\")\n    .toString();\n}\n\nexport default arrayToHtml;\n","import defaultConfig from \"./config\";\nimport empty from \"./empty\";\nimport htmlToStringArray from \"./htmlToStringArray\";\nimport textToArray from \"./textToArray\";\nimport getCandidateString from \"./getCandidateString\";\nimport arrayToHtml from \"./arrayToHtml\";\n\nimport \"./editor.scss\";\n\n/*\n\n  const e = initialize($elm, {...options})\n\n  e.onChange((candidate, versions) = console.log(candidate, versions))\n  \n  e.trigger(\"shiftaltalt\", toggleCase);\n\n  const toggleCase = el => {\n    const text = el.innerText;\n    const upper = text.toUpperCase() === text;\n    const toggle = upper ? \"toLowerCase\" : \"toUpperCase\";\n    el.innerText = text[toggle]();\n  };\n\n*/\n\nlet editor;\nlet config = { ...defaultConfig };\n\nlet cache = {\n  candidate: null, // string\n  versions: [null] // versions\n};\n\n// const re_comment_prefix = new RegExp(\"^[>]s?\", \"g\");\nconst re_punctuation = /(\\.|\\:|\\!|\\?|\\\"|\\))$/g;\nconst re_comments = /^([\\/\\>\\?\\=\\!]\\s*?)/;\nconsole.log(re_punctuation);\n\nconst triggerDictionary = {\n  cleanup: cleanupBlanks,\n  shiftshift: toggleComment\n};\n\n// [\"Lorem ipsum 1\",\"Lorem ipsum 2\",\"> Lorem ipsum 4\",\"\",\"Lorem ipsum 3\"]\nfunction clearVersions() {\n  editor.innerHTML = \"\";\n  editor = null;\n  cache.candidate = null;\n  cache.versions = [null];\n  // issue onClose event\n}\n\nfunction load(value = null, options = {}) {\n  if (!value) return;\n  if (!editor) initialize();\n\n  const array = value.constructor === Array ? value : textToArray(value);\n  const html = arrayToHtml(array);\n\n  config = Object.assign({}, config, options);\n\n  editor.innerHTML = html;\n  editor.focus();\n  notifyChanges();\n\n  return html;\n}\n\nfunction toggleComment(bool) {\n  var line = document.getSelection().focusNode.parentNode;\n  var text = line.innerText;\n  var skip = !/div/i.test(line.nodeName) || !text || !text.trim();\n\n  if (skip) return;\n\n  line.classList.toggle(\"comment\");\n}\n\nfunction cleanupBlanks(rows) {\n  [...rows].forEach((row, n) => {\n    const text = (row.innerText && row.innerText.trim()) || null;\n    text ? row : row.classList.remove(\"comment\");\n  });\n}\n\nfunction executeTriggers(e, keyTime, keyHistory) {\n  const { parentNode } = window.getSelection().focusNode;\n  const children = parentNode.children;\n\n  keyHistory = keyHistory.join(\"\").toLowerCase();\n\n  const { cleanup } = triggerDictionary;\n  const trigger =\n    triggerDictionary[keyHistory] ||\n    triggerDictionary[`id${keyHistory}`] ||\n    empty;\n\n  cleanup(children);\n  trigger(parentNode);\n  notifyChanges();\n}\n\nfunction bindEvents() {\n  let ts = 0;\n  let hist = [];\n\n  editor.onkeyup = e => {\n    const { doubleTap, resetDelay } = config;\n    const diff = e.timeStamp - ts;\n    const delay = diff < doubleTap;\n    ts = e.timeStamp;\n\n    hist = diff > resetDelay ? [] : hist;\n\n    hist.push(e.key);\n    hist = hist.slice(-5);\n\n    setTimeout(() => executeTriggers(e, delay, hist), 0);\n  };\n}\n\nfunction getVersionArray() {\n  const options = { ...config };\n  return htmlToStringArray(editor.children, options);\n}\n\nfunction notifyChanges() {\n  // if the candidate is diffrent OR\n  // if the version array is different\n  // execute the change\n  const { children } = editor;\n  const { candidate, versions } = { ...cache };\n  const { onChange } = config;\n  const string = htmlToStringArray(children);\n\n  const nextCandidate = String(getCandidateString(string));\n  const nextVersions = [...getVersionArray()];\n\n  // cheap checks first ...\n  const a = candidate !== nextCandidate;\n\n  const b = a || versions.length !== nextVersions.length;\n\n  // most expensive check\n  const execute =\n    b || versions.sort().join(\"\") !== nextVersions.sort().join(\"\");\n\n  // change detected\n  if (execute) {\n    cache = {\n      candidate: nextCandidate,\n      versions: nextVersions\n    };\n    onChange(nextCandidate, nextVersions);\n  }\n}\n\nfunction addOnChange(fn) {\n  config = Object.assign({}, config, { onChange: fn });\n}\n\nfunction trigger(key, callback) {\n  const id = triggerDictionary[key] ? `id${key}` : key;\n  triggerDictionary[id] = callback;\n  console.log(\"added trigger [%s]\", id, key);\n}\n\nfunction initialize(selector = null, options) {\n  config.selector = config.selector || selector;\n  editor = document.querySelector(config.selector);\n\n  if (!editor) {\n    throw `module requires DOM element [${selector}]`;\n  }\n\n  if (options) {\n    config = Object.assign({}, config, options);\n  }\n\n  bindEvents();\n  return {\n    load,\n    trigger,\n    clear: clearVersions,\n    settings: () => config,\n    onChange: addOnChange,\n    candidate: getCandidateString,\n    versions: htmlToStringArray\n  };\n}\n\nexport default initialize;\n","import uuid from \"../utilities/uuid\";\nimport getCandidateString from \"./getCandidateString\";\n\nfunction collectionToHtml(array) {\n  // returns HTML String\n  // Expected collection schema:\n  // [{text: String, versions: Object}, ...]\n\n  if (!array) return;\n\n  const html = array.map(row => {\n    const { text = \"\", versions = \"\" } = row;\n\n    const id = versions ? uuid() : \"\";\n    const classname = (versions && \"locked\") || \"\";\n    const value = text || (versions && getCandidateString(versions)) || \"\";\n    const json = versions ? JSON.stringify(versions) : \"\";\n\n    // create DOM element to ensure json is parsed correctly\n    // when we use it as data-version String\n    const div = document.createElement(\"div\");\n\n    // only render relavant attributes\n    id && (div.id = id);\n    classname && (div.className = classname);\n    versions && (div.dataset.versions = json);\n\n    div.innerHTML = value || \"<br/>\";\n\n    return div.outerHTML;\n  });\n\n  return html.join(\"\\n\");\n}\n\nexport default collectionToHtml;\n","import { dispatch, subscribe } from \"./functions\";\n\nimport u from \"./utilities\";\nimport initialize from \"./editor\";\nimport collectionToHtml from \"./editor/collectionToHtml\";\n\nimport \"./styles.scss\";\n\nconst messages = {\n  confirmDelete: `\n    You are unlocking this paragraph. \n\n    This will delete the working versions and destill \n    the paragraph to the currently elected candidate.\n\n    CANCEL to keep working versions\n    OK to discard versions`\n};\n\nconst editor = initialize(\"#sentences\", {\n  autoTerminate: false\n});\n\n// load some text into the DOM\nlet $focusOn; // current node element\nconst $doc = document.querySelector(\"#document\");\nconst sample = require(\"./editor/startup.json\");\nconst local = u.storage().read();\n\nfunction save($els) {\n  // parse DOM to collection\n  // save to localstrorage\n\n  const collection = [...$els].map(el => {\n    const { innerText = \"\", dataset } = el;\n    const versions = (dataset.versions && JSON.parse(dataset.versions)) || \"\";\n    return { text: innerText, versions: versions };\n  });\n\n  u.storage().write(collection);\n}\n\nfunction updateParent(e) {\n  const { candidate, versions } = e.detail;\n  document.querySelector(\"#article\").innerHTML = candidate;\n  document.querySelector(\"#versions\").innerHTML = JSON.stringify(versions);\n\n  if ($focusOn) {\n    $focusOn.innerText = candidate;\n    $focusOn.dataset.versions = JSON.stringify(versions);\n    save(document.querySelector(\"#document\").children);\n  }\n}\n\n// Initial DOM injection\n$doc.innerHTML = collectionToHtml(local || sample);\n\n// Passive events from Editor changes\neditor.onChange((candidate, versions) =>\n  dispatch(\"updateparent\", { candidate, versions })\n);\n\nsubscribe(\"updateparent\", updateParent);\n\n// Acive DOM interaction Events\ndocument.querySelector(\"#document\").ondblclick = e => {\n  e.target.id = e.target.id || u.uuid();\n  let { id, innerText, dataset } = e.target;\n  const { versions } = dataset;\n\n  if (versions) {\n    // confirm delete\n    if (!window.confirm(messages.confirmDelete)) return;\n\n    // first clear editor\n    editor.clear();\n\n    // next ... remove DOM reference\n    $focusOn.id = \"\";\n    $focusOn = null;\n\n    // next cleanup this\n    e.target.className = \"\";\n    e.target.id = \"\";\n    e.target.dataset.versions = \"\";\n\n    // update local storage\n    console.log(\"toggle off\", $focusOn);\n    return;\n  }\n\n  const text = u.inflate(innerText);\n  const value = (versions && JSON.parse(versions)) || text || \"\";\n\n  $focusOn = document.querySelector(`#${id}`);\n  $focusOn.className = \"locked selected\";\n\n  editor.load(value);\n};\n\ndocument.querySelector(\"#document\").onclick = e => {\n  // de-select any existing nodes\n  const selected = document.querySelector(\".selected\");\n  selected && selected.classList.remove(\"selected\");\n\n  // only load locked nodes\n  let { id, dataset } = e.target;\n  if (!id || !dataset.versions) return;\n\n  console.log(333, e.target);\n  $focusOn = document.querySelector(`#${id}`);\n  $focusOn.classList.add(\"selected\");\n\n  editor.load(JSON.parse(dataset.versions));\n};\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}